<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  </head>

  <body>
    <header>
      <div class="logo">
        <img src="https://i.imghippo.com/files/mc5185ONY.png" alt="Logo Kelurahan">
        <div class="text">
          <h2>Sistem Informasi Data UMKM</h2>
          <p>Kelurahan Galung Maloang</p>
        </div>
      </div>
    </header>

    <main>
      <h2 class="title">Kenali, Dukung, dan Kunjungi Usaha Warga Sekitar!</h2>
      <div class="container" id="umkmContainer"></div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <img src="https://i.imghippo.com/files/mc5185ONY.png" alt="Logo" class="footer-logo" />
        <div class="footer-text">
          <strong>Kelurahan Galung Maloang</strong><br />
          Jl. Cenderawasih, Kel. Galung Maloang, Kec. Bacukiki, Kota Parepare, Sulawesi Selatan 91125
          <p class="footer-credit">Â© 2025 KKN-T 114 Universitas Hasanuddin Kelurahan Galung Maloang</p>
        </div>
      </div>
    </footer>


  <script>
    const sheetId = "1Ch-wCcxo93LQH32ZMISJT556NdpeCNmVghqvRLDbe-0";
    const apiKey = "AIzaSyBd2Uu9BcScO1XGCJFng5ZxRtX146XDx2I";
    const range = "Sheet1!B2:G";
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

    fetch(url)
      .then(response => response.json())
      .then(data => {
        const values = data.values;
        const container = document.getElementById('umkmContainer');

        values.forEach(row => {
          const [nama, alamat, maps, , wa, foto] = row;

          let cleanNumber = wa.trim();
          if (!cleanNumber.startsWith('+')) {
            cleanNumber = cleanNumber.replace(/\D/g, ''); // buang non-angka
            if (cleanNumber.startsWith('0')) {
              cleanNumber = '+62' + cleanNumber.substring(1);
            } else {
              cleanNumber = '+62' + cleanNumber;
            }
          }

          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <img class="card-img" src="${foto}" alt="Foto ${nama}">
            <div class="card-content">
              <div class="card-info">
                <h3 class="card-title">${nama}</h3>
                <p class="card-address">${alamat}</p>
              </div>
              <div class="card-footer">
                <button class="link-btn maps" onclick="window.open('${maps}', '_blank')">
                  <i class="fa-solid fa-location-dot"></i> Maps
                </button>
                <button class="link-btn kontak" onclick="window.open('https://wa.me/${cleanNumber.replace(/\D/g, '')}', '_blank')">
                  <i class="fa-brands fa-whatsapp"></i> Kontak
                </button>
              </div>
            </div>
          `;
          container.appendChild(card);
        });
      })
      .catch(error => console.error('Gagal mengambil data:', error));
    </script>
  </body>
</html>
